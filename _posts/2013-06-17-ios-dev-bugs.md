---
layout: post
title: "ios开发小结之跳坑有感"
description: "最近跳坑比较多，多得让我想起了去年在人人那段被bug折磨的日子..."
category: devops
tags:
    - ios

---
最近跳坑比较多，多得让我想起了去年在人人那段被bug折磨的日子。坑跳多了，填坑也就有经验了，原来人人所在那个组就有这么一位填坑高手。之前疑惑这位填坑高手到底是怎么练成，如今随着接触的系统和码农多了，大致上有了一点自己的理解。填坑必须先跳坑，而坑的形成多数情况下是因为一个设计不够精良的系统经过了太多人的手，当然即使是一个设计优良的系统，被不同码农的捣腾过后也会被挖出越来越多的坑，这就像哪怕是一个大美女，被转手多了，最后也会变成找不到人来接手的黑木耳。

最近跳的一个大坑：部分用户更新app后无法启动，这个坑最后解决证实是一个小的技术问题，但在运营上而言，更新损失资深老用户是很严重的问题，绝对是大坑。具体说：[无觅阅读](https://itunes.apple.com/cn/app/wu-mi-yue-du-zhi-neng-cai/id593518746?mt=8)在使用过程中会缓存大部分的文章和图片，但在app升级的过程，由于文章格式可能更新，所以在新版本第一次启动的时候会清理一些缓存数据。但**UIApplicationDelegate**的**-application:didLaunchWithOptions:**方法有个执行时间限制为**20s**，如果执行时间超过20s，应用将被系统kill。因此，如果用户要清理的缓存数据很多（比如几百M，绝对的老用户呀），那么应用可能启动不了（特别是在一起老设备上）。这个问题的解决方式很简单，只需要将清理的操作放在background执行便可，但影响的确很糟糕。

上面所说的坑不是设计问题，而是对使用知识理解不够深入的问题，不过奇葩的一点是，在apple的文档里，时间限制是没有被提及的，google了很久也就是在[stackoverflow](http://stackoverflow.com/questions/13053230/what-are-the-differences-between-didfinishlaunchingwithoption-and-viewdidload)看到有提及，像ios这样闭源而文档也不尽完善，还是得吐槽一下！话说回来，经验不足，考虑不周是跳坑的主要原因，在手机上开发，时间和内存是重点考虑的因素，而这个重要的时间限制竟然不知道。而且这个坑在缓存多的情况下可以重现，但我们几个开发人员都没有将自己的产品使用到这个程度，看来对待自己产品的态度要改变，需要始终是自己产品的重度用户！

创业公司产品的每个用户都来之不易，如何在人力有限的情况下保证产品质量，少挖坑，少跳坑至关重要！少挖坑，需要保证代码质量，具体到objc和cocoa，尽量提炼代码很有帮助，一个文件里代码多了，调用系统的api多了，也就容易把一些注意事项忘记了，坑就形成了。下次对于代码量较多，或者比较关键的部分，打算尝试下结对编程。
