---
layout: post
title: "类pinterest网站中图片墙布局中的最优化问题"
description: "最优化问题"
category: 
tags: [pinterest]
---
{% include JB/setup %}
	> pinterest最近很火，国内也有很多公司也在做类似产品,我们团队年初也做了一个: [http://j.renren.com] 人人逛街。
	> 小菜鸟作为一个主要开发人员，在整个架构设计上遇到了很多问题，身边经验丰富的人不少，架构上的东西在请教及重构中慢慢完善。 但在细节上，还有很多小问题没有很好的解决方法，其中一个就是今天要讨论的图片墙布局最优化问题。
	
    > 具体描述为：**一个瀑布流页面（图片墙）有等宽w的C列，有M*N个宽为w，高度h不定的渲染好的层元素(DIV)， 问对于每次后台给出的M个元素，如何排放排放能使页面总体看上去更美观？
	> 问题提出的背景是，在一个读图网站，如果带宽不够的话，有一定概率给用户展示不出图片，如果图片位置没有排放匀称个话，更有可能给用户呈现出大块大块的空白，给用户极为不友好的体验。 在做人人逛街前，也调研了一下，但目前为止，没有发现国内有哪个网站在这方面有大的改观。下面是几个比较火的存在该问题的几个网站的截图：
	> 分析下描述的问题，会发现这个问题还是不够抽象，因为我们还不知道美观是如何定义的。
	> 美观的定义的确比较麻烦，但直观感觉不美观的原因就是图片墙的高度参差不齐，用数学语言描述就是高度的方差太大。 可能用方差来定义一个布局是否美观不太准确，但为了分析问题，暂且这么设定。明确了优化目标，在寻找优化手段时还需要明确可能利用的条件，在这个问题中，最关键的条件是：渲染后的M个元素是否和后台给出的M个元素保存一样的序。 如果需要保证一样的序，那么每个元素的位置已经固定，所以不存在元素调整的问题，那么，翻页可能就是一个解决方式。翻页可以解决是因为方差的累积主要源于某几个（实际情况下基本就是某一个）元素的高度特别大（比如是平均高度2-3倍），如果一直累积的话，最后页面就大片留白，所以在适当的几次下拉后翻页会将减小大片留白的概率，即使出现大片留白，通过翻页也能消除留白的持续影响。
 若是无序，解决的方式可能就比较多，自己能想到的方法有贪心和DP。其中贪心方案比较简单，但无法保证最优解，大概步骤如下：
 S1. 
